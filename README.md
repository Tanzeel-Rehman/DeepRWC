# DeepRWC: Predictive spectral analysis using an end-to-end deep model from hyperspectral images for high-throughput plant phenotyping

Code for our publication [Predictive spectral analysis using an end-to-end deep model from hyperspectral images for high-throughput plant phenotyping](https://www.sciencedirect.com/science/article/pii/S0168169920315908)  

<p>&nbsp;</p>

For Complete details on the results and data requirements, see the
original publication.
<p>&nbsp;</p>  

## **Data Balancing and Augmentation:**

<p align="center">
  <img src="media\image1.png" style="width:0.20912in;height:0.20912in" alt="Chart, histogram Description automatically generated" />
</p>

<p align="center">
  (a)
</p>

<p align="center">
  <img src="media\image2.png" style="width:1.20912in;height:1.20912in" alt="Chart, line chart Description automatically generated" />
</p>

<p align="center">
  (b)
</p>

<p>&nbsp;</p>

**Plots highlighting the spectral instances of generated by data
balancing and augmentation, (a) data balance using SMOTE-ENN, and (b)
data augmentation**

<p>&nbsp;</p>

## **Proposed Network Architecture:**

<p align="center">
  <img src="media\image3.png" style="width:3.50001in;height:1.78001in" alt="Graphical user interface Description automatically generated" />
</p>
  
<p>&nbsp;</p>

**Architecture of the proposed network, different functional blocks are
marked in different colors. The numeric values represent the number of
spatial features in each layer.**

<p>&nbsp;</p>

## **Learning Rate Finding and Scheduling:**
<p align="center">
  <img src="media\image4.png" style="width:3.20001in;height:2.43167in" alt="Chart, histogram Description automatically generated" />
</p>

<p align="center">
  (a)
</p>

<p align="center">
  <img src="media\image5.png" style="width:3.19981in;height:2.39583in" />
</p>

<p align="center">
  (b)
</p>

<p align="center">
  <img src="media\image7.png" style="width:3.13in;height:2.41589in" />
</p>

<p align="center">
  (c)
</p>

<p align="center">
  <img src="media\image9.png" style="width:3.15972in;height:2.42728in" />
</p>

<p align="center">
  (d)
</p>

<p align="center">
  <img src="media\image11.png" style="width:3.26in;height:2.45978in" />
</p>

<p align="center">
  (e)
</p>

<p>&nbsp;</p>

**Learning rate scheduling policies for the proposed network (a) LR
range test (b) triangular cyclic policy (c) exponential triangular
cyclic policy (d) one-cycle policy with linear annealing (e) one-cycle
learning policy with cosine annealing**

<p>&nbsp;</p>

## **Predicted Results on one of Test dataset:**

<p align="center">
  <img src="media\image13.png" style="width:4.84458in;height:3.65in" />
</p>

<p>&nbsp;</p>

**Laboratory measured versus predicted RWC using DeepRWC, PLSR and SVR
models (a) test-1 (b) test-2**

<p>&nbsp;</p>

## **Feature Visualization:**

<p align="center">
  <img src="media\image15.png" style="width:6.32917in;height:3.45833in" />
</p>

<p align="center">
  (a)
</p>

<p align="center">
  <img src="media\image17.png" style="width:6.39583in;height:4.25556in" />
</p>

<p align="center">
  (b)
</p>

<p>&nbsp;</p>

**Typical feature maps of trained DeepRWC, from top to bottom: input
mean spectral reflectance, examples of most active features (a) 4
feature maps of 1<sup>st</sup> convolutional layer, and (b) 5 feature
maps of 2<sup>nd</sup> convolutional layer**
